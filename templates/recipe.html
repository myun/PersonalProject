{% extends 'master.html' %}
{% block body %}

<div class="container-fluid">
    <div class="row">
        <div class="col-md-3">
            <img src={{ recipe.image_URL }} alt={{ recipe.name }} width="250" height="250" class="img-circle">
        </div>
        <div class="col-md-9">
            <form role="form" method="POST" action="/{{ username }}/save_individual_recipe/{{ recipe.name }}">
                <button type="submit" id="save-btn" class="btn btn-info btn-sm pull-right">Save to Recipe Box</button>
                <h1>{{ recipe.name }}</h1>
            </form>
             <p><span class="stars star{{recipe.rating}}"></span> ({{ recipe.num_ratings }})</p>
             <p><b>Categories:</b> {{ category_list }} <br />
                <b>Yield:</b> {{ recipe.serving_size }}<br />
                <b>Recipe courtesy of </b><a href={{ recipe.orig_URL }}>
                {{ recipe.orig_site }}</a><br />
            </p>
            {% if user_rating != "empty" %}
                <p><b>Your previous rating: </b><span class="stars star{{ user_rating }}"></span></p>
            {% endif %}

            <form role="form" method="POST" id="rating-form">
                <button type="submit" class="btn btn-default" id="btnRate" name="btnRate">Rate Me!</button>
                <span class="rating">
                    <input type="radio" class="rating-input" id="rating-input-1-5" name="rating-input-1" value="5">
                    <label for="rating-input-1-5" class="rating-star"></label>
                    <input type="radio" class="rating-input" id="rating-input-1-4" name="rating-input-1" value="4">
                    <label for="rating-input-1-4" class="rating-star"></label>                    
                    <input type="radio" class="rating-input" id="rating-input-1-3" name="rating-input-1" value="3">
                    <label for="rating-input-1-3" class="rating-star"></label>
                    <input type="radio" class="rating-input" id="rating-input-1-2" name="rating-input-1" value="2">
                    <label for="rating-input-1-2" class="rating-star"></label>
                    <input type="radio" class="rating-input" id="rating-input-1-1" name="rating-input-1" value="1">
                    <label for="rating-input-1-1" class="rating-star"></label>
                </span> 
            </form> 
            {% for message in get_flashed_messages() %}
        <li>{{ message }}</li>
    {% endfor %}
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
            <h2>Ingredients</h2>
            {% for ingredient in ingredient_list %}
                <li>{{ ingredient_list[ingredient] }} {{ ingredient }}</li>
            {% endfor %}
        </div>
        <div class="col-md-9">
            <h2>Directions</h2>
            {{ recipe.directions }}
        </div>
    </div>
    <div class="row">
        <div class="col-md-3">
        </div>
         <div class="col-md-9">
            <h2>My Notes <span id="edit-btn" class="glyphicon glyphicon-edit"></span></h2>

            {% if note_list != "empty" %}
                {% for note in note_list %}
                    <p>{{ note }}</p>
                {% endfor %}
            {% endif %}
            <div class="alert-message">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>Success!</div>

            <form role="form" method="POST" action="/{{ username }}/save_notes/{{ recipe.name }}">
                <textarea type="text" class="col-md-11" name="note-form" placeholder="Write your notes here!"></textarea>
                <button type="submit" id="save-btn" class="btn btn-info btn-sm pull-right">Save</button>
            </form>
        </div>
    </div>
</div>
<hr>

<script type="text/javascript">
    $('#edit-btn').click(function(e){
        console.log('User wishes to edit content!');
    });
    window.setTimeout(function() {
        $(".alert-message").fadeTo(500, 0).slideUp(500, function(){
        $(this).remove(); 
        });
    }, 10000);

    // $(document.ready(function(){
    //     var formSubmitButton = $("btnRate");

    //     formSubmitButton.on("click", function(event){
    //         event.preventDefault();
    //         $.ajax({
    //             url:"/<username>/recipe/<recipe_name>",
    //             method: "POST",
    //             data: $("form#rating-form").serialize(),
    //         })
    //         .done(function(data) {
    //             $()
    //         }).fail(function(){
    //             alert("FAIL");
    //         });
    //     });
</script>

{% endblock %}