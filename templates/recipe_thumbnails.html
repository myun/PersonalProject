{% extends 'master.html' %}
{% block head %}
<script src="/static/js/jquery-1.10.2.min.js" type="text/javascript"></script>
<script src="/static/js/freewall.js" type="text/javascript"></script>

<style type="text/css">
            body {
                background: rgba(231, 231, 231, 0.43);
            }
            .free-wall {
                margin: 15px;
            }
            .brick {
                width: 221.2px;
            }
            .info {
                padding: 15px;
                color: #333;
            }
            .brick img {
                margin: 0px;
                padding: 0px;
                display: block;
            }
</style>

{% endblock %}
{% block body %}

<h1>{{ page_title }}</h1> 

<div class="search-bar">
<form role="form" method="POST" action="/{{ username }}/search">
    <input type="text" class="col-md-3" name="searched_ingredient" placeholder="Search by Ingredient...">
    <button type="submit" class="btn btn-info btn-sm pull-left" id="search-btn"><span class="glyphicon glyphicon-search"></span></button>
</form>
</div>
<a href='/{{ username }}/advancedsearch'>Advanced Search</a>

<form method="POST" action="/{{ username }}/browse_recipes">
<hr>



<!-- <div class="custom-container">
    {% for category in categorized_recipes %}
        <h2><a href="#{{ category }}"> {{ category }} </a></h2>
    {% endfor %}
</div> -->

    {% for message in get_flashed_messages() %}
        <li>{{ message }}</li>
    {% endfor %}

    <button type="submit" class="btn btn-default" id="btnClick" name="btnClick">{{ button_label }}</button>

    {% for category in categorized_recipes %}
    <h2><!-- <a name={{ category}}> --> {{ category }}<!--  </a> --></h2>
    <div class="container-fluid">
        <div class="row">
            
            <div class="span12">
                
                {% for recipe in categorized_recipes[category] %}
                <div class="custom-container">
                    <div class="recipe-wrapper">
                        <a href="/{{ username }}/recipe/{{ recipe.name }}"><img src={{ recipe.image_URL }} alt={{ recipe.name }} width="250" height="225" class="img-thumbnail"></a>
                        <input type="checkbox" class="chkbox" name="recipe_checkbox" value={{ recipe.id }}> 
                    </div>
                <p><a href="/{{ username }}/recipe/{{ recipe.name }}">{{ recipe.name }}</a></p>
                <p><span class="stars star{{recipe.orig_rating}}"></span>({{ recipe.num_ratings }})</p>
                </div>
                {% endfor %}
                

            </div>

        </div>
    </div>
    {% endfor %} 
    <button type="submit" class="btn btn-default" id="btnClick" name="btnClick">{{ button_label }}</button>
    <br />
    <hr>
</form>

<script type="text/javascript">
            var wall = new freewall("#freewall");
            wall.reset({
                selector: '.brick',
                animate: true,
                cellW: 200,
                cellH: 'auto',
                onResize: function() {
                    wall.fitWidth();
                }
            });
            
            var images = wall.container.find('.brick');
            var length = images.length;
            images.css({visibility: 'hidden'});
            images.find('img').load(function() {
                -- length;
                if (!length) {
                    setTimeout(function() {
                        images.css({visibility: 'visible'});
                        wall.fitWidth();
                    }, 505);
                }
            });

        </script>

{% endblock %}